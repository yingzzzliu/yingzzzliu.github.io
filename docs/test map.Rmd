---
title: "Untitled"
author: "Liu Yingzhe"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
library(tidyverse)
library(ggplot2)
library(stringr)
library(maps)
```

```{r}
hapindex <- read.csv("dataset2019.csv")

hapindex <- hapindex %>% 
  select(region = indicator,
         "hapscore" = `world.happiness.report.score`,
         "countrycode" = `ISO.Country.code`) %>% 
  slice(-(1:4))

glimpse(hapindex)
```
```{r}
world <- map_data("world")
glimpse(world)
```

```{r}
difference <- setdiff(world$region, hapindex$region)
hapindex <- hapindex %>% 
  mutate(region = recode(str_trim(region),
                         "United States" = "USA",
                         "United Kingdom" = "UK",
                         "Korea (Rep.)" = "South Korea",
                         "Congo (Dem. Rep.)" = "Democratic Republic of the Congo",
                         "Congo (Rep.)" = "Republic of Congo",
                         "Korea (Dem. Peopleâ€™s Rep.)" = "North Korea"))

hapindex$hapscore <- as.numeric(hapindex$hapscore)
```
```{r}
worldmap <- ggplot() +
  geom_polygon(data=world, aes(x=long,
                               y=lat,
                               group=group)) +
  coord_fixed(1.3)

worldmap
```
```{r}
worldjoin <- inner_join(world, hapindex, by = "region")
worldjoin$hapscore <- as.numeric(worldjoin$hapscore)
glimpse(worldjoin)
```

```{r, echo=TRUE}
cleanup <- theme(
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  axis.title = element_blank(),
  panel.background = element_rect(fill = "white"),
  plot.title = element_text(hjust = 0.5)
)
worldHappiness <- worldjoin %>% 
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_distiller(palette = "RdYlBu", direction = -1) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=hapscore)) +
  ggtitle("World Happiness Report Scores 2017") +
  cleanup
```

```{r}
packages = c('sf', 'tmap', 'tidyverse', 'plotly','viridis','hrbrthemes', 'ggthemes')
for (p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p,character.only = T)
}
```
```{r}
install.packages(c("ggplot2", "maps"))
library(ggplot2)
library(maps)


data <- data.frame(
  country = c("Afghanistan", "Albania", "Algeria", "Argentina", "Armenia", "Australia", "Austria", "Azerbaijan", "Bahrain", "Bangladesh", "Belarus", "Belgium", "Benin", "Bhutan", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Bulgaria", "Burkina Faso", "Burundi", "Cambodia", "Cameroon", "Canada", "Chad", "Chile", "China", "Colombia", "Comoros", "Congo (Brazzaville)", "Congo (Kinshasa)", "Costa Rica", "Croatia", "Cyprus", "Czech Republic", "Denmark", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Estonia", "Ethiopia", "Finland", "France", "Gabon", "Georgia", "Germany", "Ghana", "Greece", "Guatemala", "Guinea", "Haiti", "Honduras", "Hong Kong", "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Israel", "Italy", "Ivory Coast", "Jamaica", "Japan", "Jordan", "Kazakhstan", "Kenya", "Kosovo", "Kuwait", "Kyrgyzstan", "Latvia", "Lebanon", "Liberia", "Libya", "Lithuania", "Luxembourg", "Madagascar", "Malawi", "Malaysia", "Mali", "Malta", "Mauritania", "Mauritius", "Mexico", "Moldova", "Mongolia", "Montenegro", "Morocco", "Myanmar", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", "Norway", "Pakistan", "Palestinian Territories", "Panama", "Paraguay", "Peru", "Philippines", "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saudi Arabia", "Senegal", "Serbia", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "South Africa", "South Korea", "Spain", "Sri Lanka", "Sweden", "Switzerland", "Syria", "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Togo", "Trinidad & Tobago", "Tunisia", "Turkey", "Turkmenistan", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", "Uruguay", "Uzbekistan", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"),
  happiness_score = c(3.203,
4.719,
5.211,
6.086,
4.559,
7.228,
7.246,
5.208,
6.199,
4.456,
5.323,
6.923,
4.883,
5.082,
5.779,
5.386,
3.488,
6.3,
5.011,
4.587,
3.775,
4.7,
5.044,
7.278,
4.35,
6.444,
5.191,
6.125,
4.812,
4.418,
7.167,
5.432,
6.046,
6.852,
7.6,
5.425,
6.028,
4.166,
6.253,
5.893,
4.286,
7.769,
6.592,
4.799,
4.519,
6.985,
4.996,
5.287,
6.436,
4.534,
3.597,
5.86,
5.43,
5.758,
7.494,
4.015,
5.192,
4.548,
4.437,
7.021,
7.139,
6.223,
4.944,
5.89,
5.886,
4.906,
5.809,
4.509,
6.1,
6.021,
5.261,
5.94,
5.197,
3.975,
5.525,
6.149,
7.09,
3.933,
3.41,
5.339,
4.39,
6.726,
4.49,
5.888,
6.595,
5.529,
5.285,
5.523,
5.208,
4.36,
4.913,
7.488,
7.307,
6.105,
4.628,
5.265,
7.554,
5.653,
4.696,
6.321,
5.743,
5.697,
5.631,
6.182,
5.693,
6.374,
6.07,
5.648,
3.334,
6.375,
4.681,
5.603,
4.374,
6.262,
6.198,
6.118,
4.722,
5.895,
6.354,
4.366,
7.343,
7.48,
3.462,
6.446,
5.467,
3.231,
6.008,
4.085,
6.192,
4.461,
5.373,
5.247,
4.189,
4.332,
6.825,
7.054,
6.892,
6.293,
6.174,
4.707,
5.175,
3.38,
4.107,
3.663,
)
)

# Download world map data
world_map <- map_data("world")

# Merge happiness data with map data
merged_data <- merge(world_map, data, by = "region", all.x = TRUE)

# Plot the map
ggplot(merged_data, aes(x = long, y = lat, group = group, fill = happiness_score)) +
  geom_polygon(color = "white", size = 0.5) +
  scale_fill_viridis_c(name = "Happiness Score", na.value = "grey90", option = "plasma") +
  theme_minimal() +
  labs(title = "World Happiness Score Map")

```



